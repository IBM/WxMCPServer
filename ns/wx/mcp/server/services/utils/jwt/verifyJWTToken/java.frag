<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="name">verifyJWTToken</value>
  <value name="encodeutf8">true</value>
  <value name="body">SURhdGFDdXJzb3IgcGlwZWxpbmVDdXJzb3IgPSBwaXBlbGluZS5nZXRDdXJzb3IoKTsNClN0cmlu
ZyBhdWQgPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKHBpcGVsaW5lQ3Vyc29yLCAiYXVkIik7DQpTdHJp
bmcgandrc0NvbnRlbnQgPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKHBpcGVsaW5lQ3Vyc29yLCAiandr
c0NvbnRlbnQiKTsNClN0cmluZyBiZWFyZXJUb2tlbiA9IElEYXRhVXRpbC5nZXRTdHJpbmcocGlw
ZWxpbmVDdXJzb3IsICJiZWFyZXJUb2tlbiIpOw0KcGlwZWxpbmVDdXJzb3IuZGVzdHJveSgpOw0K
DQpib29sZWFuIGlzVmFsaWQgPSBmYWxzZTsNClN0cmluZyByZWFzb24gPSAiIjsNClN0cmluZyBp
c3N1ZXIgPSAiIjsNClN0cmluZyBzdWJqZWN0ID0gIiI7DQpTdHJpbmcgY2xpZW50SWQgPSAiIjsN
ClN0cmluZyBzY29wZXMgPSAiIjsNCg0KdHJ5IHsNCglpZiAoYmVhcmVyVG9rZW4gPT0gbnVsbCB8
fCBiZWFyZXJUb2tlbi50cmltKCkuaXNFbXB0eSgpKQ0KCQl0aHJvdyBuZXcgRXhjZXB0aW9uKCJN
aXNzaW5nIGJlYXJlclRva2VuIGlucHV0LiIpOw0KDQoJLy8gTm9ybWFsaXplIGhlYWRlciBwcmVm
aXggKCJiZWFyZXIiIG9yICJCZWFyZXIiKQ0KCVN0cmluZyB0cmltbWVkID0gYmVhcmVyVG9rZW4u
dHJpbSgpOw0KCWlmICh0cmltbWVkLnRvTG93ZXJDYXNlKExvY2FsZS5ST09UKS5zdGFydHNXaXRo
KCJiZWFyZXIgIikpDQoJCXRyaW1tZWQgPSB0cmltbWVkLnN1YnN0cmluZyg3KS50cmltKCk7DQoJ
U3RyaW5nIHRva2VuID0gdHJpbW1lZDsNCg0KCVN0cmluZ1tdIHBhcnRzID0gdG9rZW4uc3BsaXQo
IlxcLiIpOw0KCWlmIChwYXJ0cy5sZW5ndGggIT0gMykNCgkJdGhyb3cgbmV3IEV4Y2VwdGlvbigi
SW52YWxpZCBKV1QgZm9ybWF0LiBFeHBlY3RlZCAzIHBhcnRzIChoZWFkZXIucGF5bG9hZC5zaWdu
YXR1cmUpLiIpOw0KDQoJLy8gRGVjb2RlIEJhc2U2NFVybCBwYXJ0cw0KCVN0cmluZyBoZWFkZXJK
c29uID0gbmV3IFN0cmluZyhCYXNlNjQuZ2V0VXJsRGVjb2RlcigpLmRlY29kZShwYXJ0c1swXSks
IFN0YW5kYXJkQ2hhcnNldHMuVVRGXzgpOw0KCVN0cmluZyBwYXlsb2FkSnNvbiA9IG5ldyBTdHJp
bmcoQmFzZTY0LmdldFVybERlY29kZXIoKS5kZWNvZGUocGFydHNbMV0pLCBTdGFuZGFyZENoYXJz
ZXRzLlVURl84KTsNCglTdHJpbmcgc2lnbmF0dXJlQjY0ID0gcGFydHNbMl07DQoNCglKU09OT2Jq
ZWN0IGhlYWRlciwgcGF5bG9hZDsNCgl0cnkgew0KCQloZWFkZXIgPSBuZXcgSlNPTk9iamVjdCho
ZWFkZXJKc29uKTsNCgkJcGF5bG9hZCA9IG5ldyBKU09OT2JqZWN0KHBheWxvYWRKc29uKTsNCgl9
IGNhdGNoIChKU09ORXhjZXB0aW9uIGplKSB7DQoJCXRocm93IG5ldyBFeGNlcHRpb24oIkludmFs
aWQgSlNPTiBpbiBKV1QgaGVhZGVyIG9yIHBheWxvYWQuIik7DQoJfQ0KDQoJU3RyaW5nIGtpZCA9
IGhlYWRlci5vcHRTdHJpbmcoImtpZCIsIG51bGwpOw0KCWlmIChraWQgPT0gbnVsbCkNCgkJdGhy
b3cgbmV3IEV4Y2VwdGlvbigiSldUIGhlYWRlciBtaXNzaW5nICdraWQnLiIpOw0KDQoJLy8gUGFy
c2UgSldLUw0KCWlmIChqd2tzQ29udGVudCA9PSBudWxsIHx8IGp3a3NDb250ZW50LmlzRW1wdHko
KSkNCgkJdGhyb3cgbmV3IEV4Y2VwdGlvbigiTWlzc2luZyBKV0tTIGNvbnRlbnQuIik7DQoNCglK
U09OT2JqZWN0IGp3a3MgPSBuZXcgSlNPTk9iamVjdChqd2tzQ29udGVudCk7DQoJSlNPTkFycmF5
IGtleXMgPSBqd2tzLm9wdEpTT05BcnJheSgia2V5cyIpOw0KCWlmIChrZXlzID09IG51bGwpDQoJ
CXRocm93IG5ldyBFeGNlcHRpb24oIkludmFsaWQgSldLUyBmb3JtYXQ6IG1pc3NpbmcgJ2tleXMn
IGFycmF5LiIpOw0KDQoJSlNPTk9iamVjdCBqd2sgPSBudWxsOw0KCWZvciAoaW50IGkgPSAwOyBp
IDwga2V5cy5sZW5ndGgoKTsgaSsrKSB7DQoJCUpTT05PYmplY3Qga2V5ID0ga2V5cy5nZXRKU09O
T2JqZWN0KGkpOw0KCQlpZiAoa2lkLmVxdWFscyhrZXkub3B0U3RyaW5nKCJraWQiKSkpIHsNCgkJ
CWp3ayA9IGtleTsNCgkJCWJyZWFrOw0KCQl9DQoJfQ0KCWlmIChqd2sgPT0gbnVsbCkNCgkJdGhy
b3cgbmV3IEV4Y2VwdGlvbigiTWF0Y2hpbmcga2V5IG5vdCBmb3VuZCBpbiBKV0tTIGZvciBraWQ9
IiArIGtpZCk7DQoNCglTdHJpbmcga3R5ID0gandrLm9wdFN0cmluZygia3R5IiwgIiIpOw0KCWlm
ICghIlJTQSIuZXF1YWxzSWdub3JlQ2FzZShrdHkpKQ0KCQl0aHJvdyBuZXcgRXhjZXB0aW9uKCJV
bnN1cHBvcnRlZCBrZXkgdHlwZTogIiArIGt0eSk7DQoNCgkvLyBCdWlsZCBSU0EgUHVibGljIEtl
eQ0KCVN0cmluZyBuU3RyID0gandrLmdldFN0cmluZygibiIpOw0KCVN0cmluZyBlU3RyID0gandr
LmdldFN0cmluZygiZSIpOw0KCWJ5dGVbXSBuQnl0ZXMgPSBCYXNlNjQuZ2V0VXJsRGVjb2Rlcigp
LmRlY29kZShuU3RyKTsNCglieXRlW10gZUJ5dGVzID0gQmFzZTY0LmdldFVybERlY29kZXIoKS5k
ZWNvZGUoZVN0cik7DQoJS2V5RmFjdG9yeSBrZXlGYWN0b3J5ID0gS2V5RmFjdG9yeS5nZXRJbnN0
YW5jZSgiUlNBIik7DQoJUHVibGljS2V5IHB1YmxpY0tleSA9IGtleUZhY3RvcnkuZ2VuZXJhdGVQ
dWJsaWMoDQoJCQluZXcgUlNBUHVibGljS2V5U3BlYyhuZXcgQmlnSW50ZWdlcigxLCBuQnl0ZXMp
LCBuZXcgQmlnSW50ZWdlcigxLCBlQnl0ZXMpKQ0KCSk7DQoNCgkvLyBWYWxpZGF0ZSBzaWduYXR1
cmUNCglTaWduYXR1cmUgc2lnID0gU2lnbmF0dXJlLmdldEluc3RhbmNlKCJTSEEyNTZ3aXRoUlNB
Iik7DQoJc2lnLmluaXRWZXJpZnkocHVibGljS2V5KTsNCglzaWcudXBkYXRlKChwYXJ0c1swXSAr
ICIuIiArIHBhcnRzWzFdKS5nZXRCeXRlcyhTdGFuZGFyZENoYXJzZXRzLlVURl84KSk7DQoNCgli
b29sZWFuIHZlcmlmaWVkID0gZmFsc2U7DQoJdHJ5IHsNCgkJYnl0ZVtdIHNpZ0J5dGVzID0gQmFz
ZTY0LmdldFVybERlY29kZXIoKS5kZWNvZGUoc2lnbmF0dXJlQjY0KTsNCgkJdmVyaWZpZWQgPSBz
aWcudmVyaWZ5KHNpZ0J5dGVzKTsNCgl9IGNhdGNoIChJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24g
aWFlKSB7DQoJCXRocm93IG5ldyBFeGNlcHRpb24oIkludmFsaWQgQmFzZTY0IGVuY29kaW5nIGlu
IHNpZ25hdHVyZS4iKTsNCgl9DQoJaWYgKCF2ZXJpZmllZCkNCgkJdGhyb3cgbmV3IEV4Y2VwdGlv
bigiSW52YWxpZCBKV1Qgc2lnbmF0dXJlLiIpOw0KDQoJLy8gVmFsaWRhdGUgZXhwaXJhdGlvbg0K
CWxvbmcgbm93ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkgLyAxMDAwTDsNCglpZiAocGF5
bG9hZC5oYXMoImV4cCIpKSB7DQoJCWxvbmcgZXhwID0gcGF5bG9hZC5nZXRMb25nKCJleHAiKTsN
CgkJaWYgKG5vdyA+IGV4cCkNCgkJCXRocm93IG5ldyBFeGNlcHRpb24oIlRva2VuIGV4cGlyZWQu
Iik7DQoJfQ0KDQoJLy8gVmFsaWRhdGUgYXVkaWVuY2UgaWYgZ2l2ZW4NCglpZiAoYXVkICE9IG51
bGwgJiYgcGF5bG9hZC5oYXMoImF1ZCIpKSB7DQoJCWJvb2xlYW4gYXVkTWF0Y2ggPSBmYWxzZTsN
CgkJT2JqZWN0IGF1ZENsYWltID0gcGF5bG9hZC5nZXQoImF1ZCIpOw0KCQlpZiAoYXVkQ2xhaW0g
aW5zdGFuY2VvZiBTdHJpbmcpIHsNCgkJCWlmIChhdWQuZXF1YWxzKGF1ZENsYWltKSkNCgkJCQlh
dWRNYXRjaCA9IHRydWU7DQoJCX0gZWxzZSBpZiAoYXVkQ2xhaW0gaW5zdGFuY2VvZiBKU09OQXJy
YXkpIHsNCgkJCUpTT05BcnJheSBhcnIgPSAoSlNPTkFycmF5KSBhdWRDbGFpbTsNCgkJCWZvciAo
aW50IGkgPSAwOyBpIDwgYXJyLmxlbmd0aCgpOyBpKyspIHsNCgkJCQlpZiAoYXVkLmVxdWFscyhh
cnIuZ2V0U3RyaW5nKGkpKSkgew0KCQkJCQlhdWRNYXRjaCA9IHRydWU7DQoJCQkJCWJyZWFrOw0K
CQkJCX0NCgkJCX0NCgkJfQ0KCQlpZiAoIWF1ZE1hdGNoKQ0KCQkJdGhyb3cgbmV3IEV4Y2VwdGlv
bigiQXVkaWVuY2UgdmFsaWRhdGlvbiBmYWlsZWQuIEZvdW5kIGF1ZGllbmNlIFwiIiArIGF1ZENs
YWltIA0KCQkJCQkgKyAiXCIsIGV4cGVjdGVkIFwiIiArIGF1ZCArICJcIi4gQ2hlY2sgZ2xvYmFs
IHZhcmlhYmxlIFwid3htY3Auand0LmF1ZGllbmNlXCIiKTsNCgl9DQoNCgkvLyBFeHRyYWN0IGlz
c3VlciBhbmQgc3ViamVjdCAoYWx3YXlzIGV4dHJhY3QsIGV2ZW4gaWYgdmFsaWRhdGlvbiBmYWls
cyBsYXRlcikNCglpZiAocGF5bG9hZC5oYXMoImlzcyIpKSB7DQoJCWlzc3VlciA9IHBheWxvYWQu
Z2V0U3RyaW5nKCJpc3MiKTsNCgl9DQoJaWYgKHBheWxvYWQuaGFzKCJzdWIiKSkgew0KCQlzdWJq
ZWN0ID0gcGF5bG9hZC5nZXRTdHJpbmcoInN1YiIpOw0KCX0NCg0KCVN0cmluZ0J1aWxkZXIgc2Nv
cGVzQnVpbGRlciA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7DQoJYm9vbGVhbiBmb3VuZFNjb3BlcyA9
IGZhbHNlOw0KDQoJLy8gQ2hlY2sgbXVsdGlwbGUgc2NvcGUgY2xhaW0gbmFtZXMgZmlyc3QNCglT
dHJpbmdbXSBzY29wZUNsYWltTmFtZXMgPSB7InNjb3BlIiwgInNjcCIsICJzY29wZXMiLCAicGVy
bWlzc2lvbnMifTsNCglmb3IgKFN0cmluZyBjbGFpbU5hbWUgOiBzY29wZUNsYWltTmFtZXMpIHsN
CgkgICAgaWYgKHBheWxvYWQuaGFzKGNsYWltTmFtZSkpIHsNCgkgICAgICAgIE9iamVjdCBzY29w
ZU9iaiA9IHBheWxvYWQuZ2V0KGNsYWltTmFtZSk7DQoJICAgICAgICBpZiAoc2NvcGVPYmogaW5z
dGFuY2VvZiBTdHJpbmcpIHsNCgkgICAgICAgICAgICBTdHJpbmdbXSBzcGxpdFNjb3BlcyA9ICgo
U3RyaW5nKXNjb3BlT2JqKS50cmltKCkuc3BsaXQoIlxccysiKTsNCgkgICAgICAgICAgICBmb3Ig
KFN0cmluZyBzIDogc3BsaXRTY29wZXMpIHsNCgkgICAgICAgICAgICAgICAgaWYgKCFzLmlzRW1w
dHkoKSkgew0KCSAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3Blc0J1aWxkZXIubGVuZ3RoKCkg
PiAwKSBzY29wZXNCdWlsZGVyLmFwcGVuZCgiICIpOw0KCSAgICAgICAgICAgICAgICAgICAgc2Nv
cGVzQnVpbGRlci5hcHBlbmQocyk7DQoJICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICB9
DQoJICAgICAgICB9IGVsc2UgaWYgKHNjb3BlT2JqIGluc3RhbmNlb2YgSlNPTkFycmF5KSB7DQoJ
ICAgICAgICAgICAgSlNPTkFycmF5IGFyciA9IChKU09OQXJyYXkpIHNjb3BlT2JqOw0KCSAgICAg
ICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyLmxlbmd0aCgpOyBpKyspIHsNCgkgICAgICAg
ICAgICAgICAgU3RyaW5nIHMgPSBhcnIub3B0U3RyaW5nKGksIG51bGwpOw0KCSAgICAgICAgICAg
ICAgICBpZiAocyAhPSBudWxsICYmICFzLmlzRW1wdHkoKSkgew0KCSAgICAgICAgICAgICAgICAg
ICAgaWYgKHNjb3Blc0J1aWxkZXIubGVuZ3RoKCkgPiAwKSBzY29wZXNCdWlsZGVyLmFwcGVuZCgi
ICIpOw0KCSAgICAgICAgICAgICAgICAgICAgc2NvcGVzQnVpbGRlci5hcHBlbmQocyk7DQoJICAg
ICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICB9DQoJICAgICAgICB9DQoJICAgICAgICBmb3Vu
ZFNjb3BlcyA9IHRydWU7DQoJICAgICAgICBicmVhazsNCgkgICAgfQ0KCX0NCg0KCS8vIEFsc28g
Y2hlY2sgQXp1cmUgInJvbGVzIiBjbGFpbSBpZiBubyBzY29wZXMgZm91bmQgeWV0DQoJaWYgKCFm
b3VuZFNjb3BlcyAmJiBwYXlsb2FkLmhhcygicm9sZXMiKSkgew0KCSAgICBKU09OQXJyYXkgcm9s
ZXNBcnIgPSBwYXlsb2FkLmdldEpTT05BcnJheSgicm9sZXMiKTsNCgkgICAgZm9yIChpbnQgaSA9
IDA7IGkgPCByb2xlc0Fyci5sZW5ndGgoKTsgaSsrKSB7DQoJICAgICAgICBTdHJpbmcgcm9sZSA9
IHJvbGVzQXJyLm9wdFN0cmluZyhpLCBudWxsKTsNCgkgICAgICAgIGlmIChyb2xlICE9IG51bGwg
JiYgIXJvbGUuaXNFbXB0eSgpKSB7DQoJICAgICAgICAgICAgaWYgKHNjb3Blc0J1aWxkZXIubGVu
Z3RoKCkgPiAwKSBzY29wZXNCdWlsZGVyLmFwcGVuZCgiICIpOw0KCSAgICAgICAgICAgIHNjb3Bl
c0J1aWxkZXIuYXBwZW5kKHJvbGUpOw0KCSAgICAgICAgfQ0KCSAgICB9DQoJfQ0KDQoJc2NvcGVz
ID0gc2NvcGVzQnVpbGRlci50b1N0cmluZygpOw0KDQoJaXNWYWxpZCA9IHRydWU7DQoJcmVhc29u
ID0gIlRva2VuIHZhbGlkLiI7DQoJDQoJLy8gVHJ5IHRvIGV4dHJhY3QgY2xpZW50IElEDQoJU3Ry
aW5nW10gY2xpZW50Q2xhaW1zID0geyJjbGllbnRfaWQiLCAiY2lkIiwgImF6cCJ9Ow0KCWZvciAo
U3RyaW5nIGNsYWltIDogY2xpZW50Q2xhaW1zKSB7DQoJICAgIGlmIChwYXlsb2FkLmhhcyhjbGFp
bSkpIHsNCgkgICAgICAgIGNsaWVudElkID0gcGF5bG9hZC5nZXRTdHJpbmcoY2xhaW0pOw0KCSAg
ICAgICAgYnJlYWs7DQoJICAgIH0NCgl9DQp9DQpjYXRjaCAoRXhjZXB0aW9uIGUpIHsNCglpc1Zh
bGlkID0gZmFsc2U7DQoJcmVhc29uID0gZS5nZXRNZXNzYWdlKCkgIT0gbnVsbCA/IGUuZ2V0TWVz
c2FnZSgpIDogIlVua25vd24gdmFsaWRhdGlvbiBlcnJvci4iOw0KfQ0KDQovLyBPdXRwdXQgcmVz
dWx0cw0KSURhdGFDdXJzb3Igb3V0ID0gcGlwZWxpbmUuZ2V0Q3Vyc29yKCk7DQpJRGF0YVV0aWwu
cHV0KG91dCwgImlzVmFsaWQiLCBpc1ZhbGlkKTsNCklEYXRhVXRpbC5wdXQob3V0LCAicmVhc29u
IiwgcmVhc29uKTsNCklEYXRhVXRpbC5wdXQob3V0LCAiaXNzdWVyIiwgaXNzdWVyKTsNCklEYXRh
VXRpbC5wdXQob3V0LCAic3ViamVjdCIsIHN1YmplY3QpOw0KSURhdGFVdGlsLnB1dChvdXQsICJj
bGllbnRJZCIsIGNsaWVudElkKTsNCklEYXRhVXRpbC5wdXQob3V0LCAic2NvcGVzIiwgc2NvcGVz
KTsNCg0Kb3V0LmRlc3Ryb3koKTs=</value>
</Values>
